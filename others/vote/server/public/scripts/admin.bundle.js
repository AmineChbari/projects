(()=>{"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}var e=io(),n={subject:"",votes:new Map},o=function(){document.getElementById("admin").style.display="block",u("Connecté en tant qu'administrateur")};e.on("voter_connect",(function(){var t=document.getElementById("participant"),e=parseInt(t.textContent)||0;t.textContent=e+1})),e.on("voter_disconnect",(function(){var t=document.getElementById("participant"),e=parseInt(t.textContent)||0;e>0&&(t.textContent=(e-1).toString())}));var r=function(){var t=document.getElementById("sujet").value.trim();t&&(n.subject=t,n.votes.clear(),document.getElementById("end").disabled=!1,document.getElementById("start").disabled=!0,document.getElementById("sujet").disabled=!0,e.emit("start_vote",t),d(),document.getElementById("votes_count").textContent="0")},c=function(){e.emit("end_vote"),document.getElementById("end").disabled=!0,document.getElementById("start").disabled=!1,document.getElementById("sujet").disabled=!1,document.getElementById("sujet").value="",document.getElementById("votes_count").textContent="0",document.getElementById("vote_pour").textContent="0",document.getElementById("vote_contre").textContent="0",document.getElementById("vote_nppv").textContent="0",document.getElementById("vote_abst").textContent="0",n.votes.clear()},a=function(t,e){n.votes.set(t,e),d()},d=function(){var e={pour:0,contre:0,nppv:0,abst:0};n.votes.forEach((function(t){var n="abstention"===t?"abst":t;e.hasOwnProperty(n)&&e[n]++})),Object.entries(e).forEach((function(e){var n,o,r=(o=2,function(t){if(Array.isArray(t))return t}(n=e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,c,a,d=[],u=!0,i=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=c.call(n)).done)&&(d.push(o.value),d.length!==e);u=!0);}catch(t){i=!0,r=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(i)throw r}}return d}}(n,o)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=r[0],a=r[1],d=document.getElementById("vote_".concat(c));d&&(d.textContent=a)}));var o=document.getElementById("votes_count");o&&(o.textContent=n.votes.size)},u=function(t){document.getElementById("message").textContent=t},i=function(){sessionStorage.setItem("adminRefusedMessage","Connexion refusée : il y a déjà un administrateur connecté."),window.location.href="/",alert("Connexion refusée : il y a déjà un administrateur connecté.")};console.log("Vous avez été déconnecté."),e.on("welcome",(function(){var t,n;console.log("Connected as admin"),e.emit("admin_connect"),e.on("admin_accepted",o),e.on("admin_refused",i),e.on("new_vote",a),e.on("bye",(function(){return console.log("Disconnected from server")})),t=document.getElementById("start"),n=document.getElementById("end"),document.getElementById("sujet").addEventListener("input",(function(e){t.disabled=!e.target.value.trim()})),t.addEventListener("click",r),n.addEventListener("click",c)})),e.on("bye",(function(){return document.getElementById("message").textContent="Vous avez été déconnecté."}))})();